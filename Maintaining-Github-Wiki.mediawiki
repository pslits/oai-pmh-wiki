= Maintaining the GitHub Wiki =

== Introduction ==

The OAI-PMH Wiki serves as a centralized repository for documentation, technical overviews, and usage guidelines related to the OAI-PMH project. Hosted on GitHub, it provides an accessible platform for sharing information. However, editing the GitHub Wiki directly through the browser interface presents several limitations:

* **Immediate Live Changes**: Edits are published instantly without prior review, increasing the risk of errors.
* **Limited Collaboration Support**: The lack of pull request (PR) workflows makes collaborative editing and peer reviews challenging.
* **Basic Version Control**: While wikis are Git repositories, the version control features are not as robust or transparent as those in standard Git workflows.

To address these challenges, we have adopted a more structured approach by maintaining the wiki content in a **dedicated GitHub repository** â€” `oai-pmh-wiki`. This separate repository mirrors the structure and content of the actual GitHub Wiki (`oai-pmh.wiki`) but enables a more professional development workflow. Contributors can:

* **Propose Edits via Pull Requests**: Allowing for code reviews and discussions before changes are merged.
* **Collaborate Effectively**: Utilizing branches and PRs facilitates better collaboration among team members.
* **Leverage Continuous Integration (CI)**: Automated workflows can validate changes, generate diagrams, and synchronize content with the live wiki.

This setup brings the benefits of software development best practices to documentation. Version control becomes reliable and transparent, accidental overwrites are avoided, and the review process ensures higher-quality contributions. Automated GitHub Actions are used to synchronize the content of the `oai-pmh-wiki` repository with the actual GitHub Wiki, ensuring that only approved changes are published.

This guide provides step-by-step instructions for contributing to the wiki using this new workflow. Whether you're fixing a typo, adding a diagram, or documenting an entire feature, you'll learn how to make and propose changes in a way that is maintainable, reviewable, and traceable.

== Setup of the separate repository ==

The wiki is maintained in a separate repository called ''oai-pmh-wiki''. This repository contains all the markdown files and assets used in the wiki. The actual GitHub Wiki is a separate repository called ''oai-pmh.wiki''.

=== Creating the separate repository ===
To set up the separate repository, follow these steps:
# Clone the ''oai-pmh.wiki'' repository
# Rename the cloned directory to ''oai-pmh-wiki''
# Create a new repository on GitHub named ''oai-pmh-wiki''
# Remove the origin from the cloned repository
# Add the new repository as the origin
# Push the cloned repository to the new GitHub repository

=== Create workflow ===
# Create a new directory called <code>.github/workflows</code> in the ''oai-pmh-wiki'' repository.
# Inside this directory, create a new file called <code>push-wiki.yml</code>.
# Add the following content to the <code>push-wiki.yml</code> file:

== Repository Structure ==

The repository structure is as follows:
* '''oai-pmh-wiki''': The main repository where all wiki content is stored and versioned.
* '''oai-pmh.wiki''': The actual GitHub Wiki repository, which is a mirror of the ''oai-pmh-wiki'' repository.

== How It Works ==

* The ''oai-pmh.wiki'' repository is a GitHub Wiki that is automatically updated from the ''oai-pmh-wiki'' repository.
* The ''oai-pmh-wiki'' repository is where all contributors work on the wiki content.
* Contributors can clone the ''oai-pmh-wiki'' repository, make changes, and submit pull requests.
* The pull requests are reviewed and merged into the ''master'' branch of the ''oai-pmh-wiki'' repository.
* Once a pull request is merged, a GitHub Action is triggered to push the changes to the ''oai-pmh.wiki'' repository.

== How to Make Changes ==

To make changes to the wiki, follow these steps:
# Clone the ''oai-pmh-wiki'' repository to your local machine.
    
<syntaxhighlight lang="bash">
git clone https://github.com/pslits/oai-pmh-wiki.git
cd oai-pmh-wiki
</syntaxhighlight>

# Create a new branch for your changes.

<syntaxhighlight lang="bash">
git checkout -b update-wiki-section
</syntaxhighlight>

# Make your edits to the markdown files in the repository.
    * For example, if you want to update the section on harvesting, edit the corresponding markdown file.
    * You can also create new markdown files or folders as needed.

# Commit your changes and push them to the new branch.

<syntaxhighlight lang="bash">
git add .
git commit -m "Update wiki section on harvesting"
git push origin update-wiki-section
</syntaxhighlight>

# Open a pull request from your branch into the ''master'' branch of the ''oai-pmh-wiki'' repository.
    * Go to the ''oai-pmh-wiki'' repository on GitHub.
    * Click on the ''Pull requests'' tab.
    * Click on the ''New pull request'' button.
    * Select your branch from the dropdown menu and click ''Create pull request''.
    * Add a title and description for your pull request, explaining the changes you made.
# Once the pull request is reviewed and approved, it will be merged into the ''master'' branch.
    * This triggers a GitHub Action that automatically pushes the changes to the actual GitHub Wiki (''oai-pmh.wiki'').

== Setting Up GitHub Secrets ==

To enable the GitHub Action to push changes to the ''oai-pmh.wiki'' repository, you need to set up some repository secrets in the ''oai-pmh-wiki'' repository. These secrets are used for authentication and commit attribution.
* Go to the ''oai-pmh-wiki'' repository on GitHub.
* Click on the ''Settings'' tab.
* In the left sidebar, click on ''Secrets and variables''.
* Click on ''Actions''.
* Click on the ''New repository secret'' button.
* Add the following secrets:
{| class="wikitable"
! Name !! Description
|-
| API_KEY || GitHub Personal Access Token with <code>repo</code> & <code>wiki</code> access
|-
| USERNAME || Your GitHub username (used for commit attribution)
|-
| EMAIL || Your GitHub email (used for commit attribution)
|}

== CI Workflow (Simplified) ==

The GitHub Action workflow is defined in the <code>.github/workflows/push-wiki.yml</code> file. This workflow is triggered whenever a pull request is merged into the ''master'' branch of the ''oai-pmh-wiki'' repository.
The workflow performs the following steps:
# Clones the ''oai-pmh-wiki'' repository.
# Remove origin from the cloned repository.
# Adds the ''oai-pmh.wiki'' repository as the new origin.
# Configures Git with the provided username and email for commit attribution.
# Pushes the changes from the ''master'' branch of the ''oai-pmh-wiki'' repository to the ''oai-pmh.wiki'' repository.

This ensures all changes go through code review and version control.
